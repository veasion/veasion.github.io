<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>flow流程</title>
</head>
<body>
<div id="context" style="display:none;">
graph TD
a1((节点A))-->a2[节点B]
a2-->|描述|a3[节点C]
a3-->a4{判断}
a4-->|true|xxx1
a4-->|false|xxx2
</div>
<select id="type" onchange="change()">
<option value="TD">竖向</option>
<option value="LR">横向</option>
</select>
<div id="mermaid" class="mermaid" style="margin-top: 15px;text-align: center;">
</div>
<script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/mermaid/8.11.2/mermaid.min.js"></script>
<script>
function init() {
let value = document.getElementById("type").value;
let idx = location.href.lastIndexOf('?type=');
if (idx > -1) {
	value = location.href.substring(idx + 6);
}
document.getElementById("type").value = value;
let context = document.getElementById("context").innerText;
document.getElementById("mermaid").removeAttribute("data-processed");
document.getElementById("mermaid").innerHTML = context.replace('graph LR', 'graph ' + value).replace('graph TD', 'graph ' + value);
mermaid.initialize({
startOnLoad: true, 
theme: 'default',
logLevel:'fatal',
securityLevel:'strict',
arrowMarkerAbsolute: false,
fontFamily: 'arial',
flowchart:{
useMaxWidth: false,
htmlLabels: true,
curve: 'linear',
nodeSpacing: 40
}
});
}

function change() {
	let url='';
	let idx = location.href.lastIndexOf('?');
	if (idx > -1) {
	  url=location.href.substring(0, location.href.lastIndexOf('?'));
	} else {
	  url=location.href;
	}
	let value = document.getElementById("type").value;
	location.href=url+'?type=' + value;
}

init();
</script>

</body>
</html>